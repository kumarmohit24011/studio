rules_version = '2';

// Rules for Firebase Storage
//
// - Public Read for Images: All users can read images from the `products`
//   and site content directories (`hero-images`, `promo-images`). This is
//   necessary for the storefront to display them.
// - Authenticated Write for Images: Any authenticated user can write
//   (upload, update, delete) images. This is secure because only admins
//   can access the parts of the app that allow uploads.
service firebase.storage {
  match /b/{bucket}/o {

    // Default deny all reads and writes to ensure no path is left unsecured.
    match /{allPaths=**} {
      allow read, write: if false;
    }

    // Allow public read access to product, hero, and promo images.
    // Allow authenticated users to write to these paths.
    // The UI (admin panel) should be the gatekeeper for who can upload.
    match /products/{imageName=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    match /hero-images/{imageName=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    match /promo-images/{imageName=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }
  }
}
